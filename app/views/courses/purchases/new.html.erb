<main class="mw8 pa3 center">
  <h3>Review your order</h3>

  <div class="d-f">
    <div class="f-1 ba b--black-30 pa3">
      <div class="d-f ai-fs">
        <div class="ba b--black-30 fl">
          <%= embedded_svg(@course.cover, size: "6rem") %>
        </div>

        <div class="f-1 ml2">
          <dd><strong><%= @course.title %></strong></dd>
          <dd><strong>Lifetime</strong></dd>
        </div>
      </div>
    </div>

    <div class="ml3 pa3 ba b--black-30">
      <% if current_user %>
        <%= form_tag course_purchases_path, class: "tc" do %>
          <script
            src="https://checkout.stripe.com/checkout.js" class="stripe-button"
            data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
            data-description="buy course"
            data-amount="<%= @course.price %>"
            data-locale="auto"
          ></script>

          <article class="mt3">
            <% if flash[:error].present? %>
              <div id="error_explanation">
                <p><%= flash[:error] %></p>
              </div>
            <% end %>
            <p class="tc">
              <small>
                By buying this course, you agree to<br />learnreact.com's <a href="/terms" target="_blank" rel="noopener">Terms and Conditions of Use</a>.
              </small>
            </p>
            <hr />
            <label class="amount">
              <span style="font-weight: bold; color: #b12704">Order Total: <%= number_to_currency(@course.price / 100) %></span>
            </label>
          </article>
        <% end %>
      <% else %>
        <article>
          <div class="tc">
            <%= link_to 'Sign in to buy', signin_path, class: "btn action-btn", "data-no-turbolink": true %>
          </div>

          <% if flash[:error].present? %>
            <div id="error_explanation">
              <p><%= flash[:error] %></p>
            </div>
          <% end %>
          <p class="tc">
            <small>
              By buying this course, you agree to<br />learnreact.com's <a href="/terms" target="_blank" rel="noopener">Terms and Conditions of Use</a>.
            </small>
          </p>
          <hr />
          <label class="amount">
            <span style="font-weight: bold; color: #b12704">Order Total: <%= number_to_currency(@course.price / 100) %></span>
          </label>
        </article>
      <% end %>
    </div>
  </div>
</main>
